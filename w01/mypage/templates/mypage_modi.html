{% extends 'main_navi_base.html' %}
{% load static %}
<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name='csrf_token' content='{{csrf_token}}'>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" as="style" crossorigin href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/variable/pretendardvariable.min.css" />
  <script src="https://code.jquery.com/jquery-latest.min.js"></script>
  <title>회원 정보 수정</title>
</head>
<body>
  {% block container-block%}
  <div id="container">
    <div id="mypage_top">
      <span>마이페이지</span>
    </div>
    <div class="mypage_cont_title">
      <span>회원정보 수정</span>
    </div>
    <div class="mypage_cont">
      <div class="mypage_name">
        <span>이름</span>
        <div>
          <input type="text" value='{{mem_info.name}}' readonly>
        </div>
      </div>
      <div class="mypage_id">
        <span>아이디</span>
        <div>
          <input type="text" value='{{mem_info.id}}' readonly>
        </div>
      </div>
      <div class="mypage_pw">
        <span>비밀번호</span>
        <button type="button" class="mypage_pw_chgbtn">비밀번호 변경</button>
        <div class="mypage_pw_chg">
          <h3>비밀번호 변경</h3>
          <div>
            <span>현재 비밀번호</span>
            <input type="text" placeholder="현재 비밀번호를 입력하세요" name='curr_pw' class="mypage_pw_now" id="mypage_pw_now"><button type='button' class='pw_chkbtn'>비밀번호 확인</button>
            <p>비밀번호가 일치합니다.</p>
          </div>
          <div>
            <span>비밀번호 변경</span>
            <input type="text" placeholder="영문, 숫자, 특수 기호 포함 8자리" id="mypage_pw_chg1">
          </div>
          <div>
            <span>비밀번호 확인</span>
            <input type="text" placeholder="비밀번호를 다시 입력하세요" id="mypage_pw_chg2">
          </div>
          <button type="button">변경하기</button>
        </div>
      </div>
      <div class="mypage_nicname">
        <span>닉네임</span>
        <div>
          <input type="text" value='{{mem_info.nicName}}'>
        </div>
      </div>
      <div class="mypage_email">
        <span>이메일</span>
        <div class="mypage_email">
          <input type="text" value='{{mail_id}}'>
          <p>@</p>
          <select class="mypage_email2" name="mypage_email2" id='mypage_email2'>
            <option value="naver.com" {% if mail_domain == 'naver.com' %} selected {% endif %}>naver.com</option>
            <option value="gmail.com" {% if mail_domain == 'gmail.com' %} selected {% endif %}>gmail.com</option>
            <option value="hanmail.net" {% if mail_domain == 'hanmail.net' %} selected {% endif %}>hanmail.net</option>
            <option value="nate.com" {% if mail_domain == 'nate.com' %} selected {% endif %}>nate.com</option>
          </select>
        </div>
      </div>
      <div class="mypage_gender">
        <span>성별</span>
        <div class='mypage_gender_chk'>
          <input type="radio" id="mypage_gender_m" value="남자" name="mypage_gender" {% if mem_info.gender == '남자' %} checked {% endif %}>
          <label for="mypage_gender_m">남자</label>
          <input type="radio" id="mypage_gender_f" value="여자" name="mypage_gender" {% if mem_info.gender == '여자' %} checked {% endif %}>
          <label for="mypage_gender_f">여자</label>
        </div>
      </div>
      <div class="mypage_birth">
        <span>생일</span>
        <div>
          <input type="text" value='{{mem_info.birthday}}'>
        </div>
      </div>
    </div>
    <div id="mypage_modi_btn">
      <button type="button">수정하기</button>
      <button type="button">수정취소</button>
    </div>
  </div>
  <script>
    // 자주 묻는 질문 슬라이드
    $(document).ready(function() {
      $('.mypage_pw_chgbtn').click(function() {
        $(this).next('.mypage_pw_chg').slideToggle(300); // 300ms 동안 슬라이드
        $(this).toggleClass('active'); // 열림/닫힘 상태 관리 (추가 스타일링 가능)
      });

      // 비밀번호 확인
      const csrfToken = $('meta[name="csrf_token"]').attr('content')
      $('.pw_chkbtn').click(function() {
        console.log($('.mypage_pw_now').val())
        const currPw = $('.mypage_pw_now').val()
        
        // ajax 시작
        $.ajax({
          url: '/modify/currpw_chk/',
          type: 'post',
          headers:{'X-CSRFToken':csrfToken},
          data:{'currPw':currPw},
          success:function(data){
            if(data.result == 'success'){
              alert('비밀번호 확인 완료')
            }else{
              alert('아님')
            }
          },
          error:function(){
            alert('실패')
          }
        }); // ajax 끝
      });

    });
  </script>
  {% endblock container-block%}
</body>
</html>